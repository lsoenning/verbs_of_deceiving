---
title: "Untitled"
output: html_document
---

R packages

```{r}
library(tidyverse)
library(lattice)
library(arm)
library(vcdExtra)
```

# Load data

First we load the data, then select only *delude*:

```{r}
data_merged <- read.csv("./data/data_merged.csv", stringsAsFactors = T)

data_delude <- subset(data_merged, verb=="delude")
data_delude <- subset(data_delude, transitivity!="intransitive")
data_delude$year_c <- (data_delude$year - 2000)/50

data_delude <- droplevels(data_delude)
str(data_delude)
```

# Data screening

Inspect different variables via contingency tables:

```{r}
xtabs(~variety, data=data_delude)
```


```{r}
xtabs(~corpus, data=data_delude)
```

```{r}
xtabs(~genre, data=data_delude)
```

```{r}
xtabs(~negation, data=data_delude)
```

```{r}
xtabs(~transitivity, data=data_delude)
```

For YEAR, we use a graph:

```{r fig.height=3, fig.width=3}
histogram(~year, data=data_delude)
```

# Delude: Synchronic data

Exclude COHA data and the single intransitive token:

```{r}
delude_syn <- subset(data_delude, corpus!="COHA")
delude_syn <- droplevels(delude_syn)
str(delude_syn)
```

## Data screening 

### Individual variables

Inspect different variables via contingency tables:

```{r}
xtabs(~variety, data=delude_syn)
```


```{r}
xtabs(~corpus, data=delude_syn)
```

```{r}
xtabs(~genre, data=delude_syn)
```

```{r}
xtabs(~negation, data=delude_syn)
```

```{r}
xtabs(~transitivity, data=delude_syn)
```

For YEAR, we use a graph:

```{r fig.height=3, fig.width=3}
histogram(delude_syn$year)
```

Break down YEAR by variety:

```{r fig.height=3, fig.width=5}
histogram(~year | variety, data=delude_syn)
```



### Cross-tabulations

We inspect (i) absolute frequencies (ii) relative frequencies, and (iii) a graph of relative frequencies. The graphs are called "doubledecker graphs". They show the proportions vertically and the absolute counts horizontally (width of bars). 

TRANSITIVITY x NEGATION

```{r}
xtabs(~ negation + transitivity, data=delude_syn)
```

```{r}
round(
  prop.table(
    xtabs(~ negation + transitivity, data=delude_syn), 
    margin = 2),
  2)
```

```{r fig.height=2.5, fig.width=4}
doubledecker(xtabs(~ transitivity + negation, data=delude_syn))
```

TRANSITIVITY x GENRE

```{r}
xtabs(~transitivity + genre, data=delude_syn)
```

```{r}
round(
  prop.table(
    xtabs(~transitivity + genre, data=delude_syn), 
    margin = 2),
  2)
```

```{r fig.height=2.5, fig.width=6}
doubledecker(xtabs(~ genre + transitivity, data=delude_syn))
```


NEGATION x GENRE

```{r}
xtabs(~negation + genre, data=delude_syn)
```

```{r}
round(
  prop.table(
    xtabs(~negation + genre, data=delude_syn), 
    margin = 2),
  2)
```

```{r fig.height=2.5, fig.width=6}
doubledecker(xtabs(~ genre + negation, data=delude_syn))
```

VARIETY x GENRE

```{r}
xtabs(~variety + genre, data=delude_syn)
```

# Analysis

It would make sense to proceed in three steps:

- (1) Diachronic trend with COHA data, possibly with COHA + COCA (but exclude SPK from COCA)
- (2) Synchronic comparison between varieties, only NEWS
- (3) Synchronic analysis of internal constraints, only AmE data


## Diachronic analysis

### Data

Select relevant data and rescale YEAR (2000 -> 0; 50-year steps: 1950 -> -1 ...):

```{r}
delude_dia <- subset(data_delude, corpus=="COHA")
str(delude_dia)
```

### Visualization of time trend

```{r fig.height=3, fig.width=4}
spineplot(delude_dia$year, delude_dia$interpretator)
```


```{r fig.height=3, fig.width=4}
cdplot(delude_dia$year, delude_dia$interpretator)

```

### Logistic regression

```{r}
model_dia <- glm(interpretator ~ year_c, data=delude_dia, family="binomial")
display(model_dia)
```

```{r}
help("effectsTheme")
```


```{r fig.height=3, fig.width=4}
plot(effects::allEffects(
  model_dia, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))))
```


## Synchronic analysis

```{r}
model_syn <- glm(interpretator ~ negation + genre + transitivity, 
                 data=subset(delude_syn, variety=="AmE"),
                 family="binomial")
arm::display(model_syn)
```

```{r fig.height=3, fig.width=8}
plot(effects::predictorEffect(
  "negation",
  model_syn, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=1, nrow=1, ncol=3, more=T)
  ),
  main="Negation", xlab="")

plot(effects::predictorEffect(
  "genre",
  model_syn, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=2, nrow=1, ncol=3, more=T)
  ),
  main="Genre", xlab="", ylab="")

plot(effects::predictorEffect(
  "transitivity",
  model_syn, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=3, nrow=1, ncol=3, more=F)
  ),
  main="Transitivity", xlab="", ylab="")
```

## Compariosn of varieties

```{r}
model_var <- glm(interpretator ~ negation + transitivity + variety + year_c, 
                 data=subset(delude_syn, genre=="NEWS"),
                 family="binomial")
arm::display(model_var)
```

```{r fig.height=3, fig.width=9}
plot(effects::predictorEffect(
  "year_c",
  model_var, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=1, nrow=1, ncol=4, more=T)
  ),
  main="Year", xlab="")

plot(effects::predictorEffect(
  "negation",
  model_var, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=2, nrow=1, ncol=4, more=T)
  ),
  main="Negation", xlab="", ylab="")

plot(effects::predictorEffect(
  "variety",
  model_var, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=3, nrow=1, ncol=4, more=T)
  ),
  main="Variety", xlab="", ylab="")

plot(effects::predictorEffect(
  "transitivity",
  model_var, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=4, nrow=1, ncol=4, more=F)
  ),
  main="Transitivity", xlab="", ylab="")
```

## See whether patterns are similar scross varieties: (Separate) parallel analysis

### AmE

```{r}
model_AmE <- glm(interpretator ~ negation + transitivity + year_c, 
                 data=subset(delude_syn, genre=="NEWS" & variety =="AmE"),
                 family="binomial")
arm::display(model_AmE)
```

```{r fig.height=3, fig.width=9}
plot(effects::predictorEffect(
  "year_c",
  model_AmE, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=1, nrow=1, ncol=3, more=T)
  ),
  main="Year", xlab="")

plot(effects::predictorEffect(
  "negation",
  model_AmE, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=2, nrow=1, ncol=3, more=T)
  ),
  main="Negation", xlab="", ylab="")

plot(effects::predictorEffect(
  "transitivity",
  model_AmE, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=3, nrow=1, ncol=3, more=F)
  ),
  main="Transitivity", xlab="", ylab="")
```


### BrE

```{r}
model_BrE <- glm(interpretator ~ negation + transitivity + year_c, 
                 data=subset(delude_syn, genre=="NEWS" & variety =="BrE"),
                 family="binomial")
arm::display(model_BrE)
```

```{r fig.height=3, fig.width=9}
plot(effects::predictorEffect(
  "year_c",
  model_BrE, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=1, nrow=1, ncol=3, more=T)
  ),
  main="Year", xlab="")

plot(effects::predictorEffect(
  "negation",
  model_BrE, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=2, nrow=1, ncol=3, more=T)
  ),
  main="Negation", xlab="", ylab="")

plot(effects::predictorEffect(
  "transitivity",
  model_BrE, 
  confidence.level=.95), 
  axes=list(
    y=list(
      type="response",
      lim=c(0,1))),
  lattice=list(
    array=list(row=1, col=3, nrow=1, ncol=3, more=F)
  ),
  main="Transitivity", xlab="", ylab="")
```